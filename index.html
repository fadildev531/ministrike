<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MiniStrike</title>

<style>
body{
  margin:0;
  background:#111;
  color:white;
  font-family:Arial;
  text-align:center;
  overflow:hidden;
}

canvas{
  background:#222;
  border:3px solid white;
  margin-top:10px;
}

.menu{
  position:absolute;
  width:100%;
  height:100%;
  background:linear-gradient(#000,#222);
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  z-index:10;
}

.menu button{
  padding:12px 25px;
  margin:10px;
  font-size:18px;
  border:none;
  background:orange;
  border-radius:8px;
}

.hidden{
  display:none;
}

#controls button{
  width:60px;
  height:60px;
  font-size:22px;
  margin:5px;
}
</style>
</head>

<body>

<div id="startMenu" class="menu">
  <h1>ğŸ”¥ MiniStrike</h1>
  <button onclick="startGame()">â–¶ PLAY</button>
</div>

<div id="gameOverMenu" class="menu hidden">
  <h1>ğŸ’€ GAME OVER</h1>
  <p id="finalScore"></p>
  <button onclick="restartGame()">ğŸ” RESTART</button>
</div>

<h3>HP: <span id="hp">100</span> | Kills: <span id="kills">0</span></h3>

<canvas id="gameCanvas" width="300" height="300"></canvas>

<div id="controls">
<br>
<button onclick="move(0,-15)">â¬†</button><br>
<button onclick="move(-15,0)">â¬…</button>
<button onclick="shoot()">ğŸ”«</button>
<button onclick="move(15,0)">â¡</button><br>
<button onclick="move(0,15)">â¬‡</button>
</div>

<script>
let canvas = document.getElementById("gameCanvas");
let ctx = canvas.getContext("2d");

let player, enemies, hp, kills;
let gameRunning = false;
let enemySpeed = 1.2;

/* SOUND */
function playShootSound(){
  let audio = new Audio("https://actions.google.com/sounds/v1/impacts/metal_thud_and_hit.ogg");
  audio.play();
}

/* START */
function startGame(){
  document.getElementById("startMenu").classList.add("hidden");
  initGame();
}

function restartGame(){
  document.getElementById("gameOverMenu").classList.add("hidden");
  initGame();
}

function initGame(){
  player = {x:150,y:150,size:20};
  enemies = [];
  hp = 100;
  kills = 0;
  gameRunning = true;
  spawnEnemies();
  gameLoop();
}

/* SPAWN */
function spawnEnemies(){
  setInterval(()=>{
    if(gameRunning){
      enemies.push({
        x:Math.random()*280,
        y:Math.random()*280,
        size:20
      });
    }
  },1500);
}

/* MOVE */
function move(dx,dy){
  if(!gameRunning) return;
  player.x += dx;
  player.y += dy;
}

/* SHOOT */
function shoot(){
  if(!gameRunning) return;
  playShootSound();
  enemies.forEach((e,i)=>{
    if(Math.abs(e.x-player.x)<30 && Math.abs(e.y-player.y)<30){
      enemies.splice(i,1);
      kills++;
    }
  });
}

/* GAME LOOP */
function gameLoop(){
  if(!gameRunning) return;

  ctx.clearRect(0,0,300,300);

  // PLAYER
  ctx.fillStyle="cyan";
  ctx.fillRect(player.x,player.y,player.size,player.size);

  // ENEMIES
  ctx.fillStyle="red";
  enemies.forEach(e=>{

    // NGEJAR PLAYER
    let dx = player.x - e.x;
    let dy = player.y - e.y;
    let distance = Math.sqrt(dx*dx + dy*dy);

    if(distance>0){
      e.x += (dx/distance)*enemySpeed;
      e.y += (dy/distance)*enemySpeed;
    }

    ctx.fillRect(e.x,e.y,e.size,e.size);

    // COLLISION
    if(Math.abs(e.x-player.x)<20 && Math.abs(e.y-player.y)<20){
      hp -= 1;
    }
  });

  document.getElementById("hp").innerText = hp;
  document.getElementById("kills").innerText = kills;

  if(hp<=0){
    gameRunning=false;
    document.getElementById("finalScore").innerText="Final Kills: "+kills;
    document.getElementById("gameOverMenu").classList.remove("hidden");
    return;
  }

  requestAnimationFrame(gameLoop);
}
</script>

</body>
</html>
